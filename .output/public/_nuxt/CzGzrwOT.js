import{_ as se}from"./BP5qj2Nh.js";import{d as Y,x as p,y as g,z as t,A as m,a8 as de,u as re,B as n,C as a,a2 as ue,M as o,I as W,V as N,L as V,Q as F,R as Z,g as x,N as b,D as d,a3 as D,Z as _,S as pe,T as q,U as J,a9 as z,$ as I,aa as P,J as G,O as me,Y as ve,X as fe,a0 as Q,k as ge,_ as ce}from"./DG-Bmc7c.js";import{u as xe}from"./Drcv-Wji.js";const be={class:"stat-card"},ye={class:"stat-label"},Ve=Y({__name:"StatCard",props:{label:{},value:{},color:{}},setup(S){return(R,f)=>(p(),g("div",be,[t("div",ye,m(S.label),1),t("div",{class:"stat-value",style:de(S.color?`color:${S.color}`:"")},m(S.value),5)]))}}),ke=Object.assign(Ve,{__name:"StatCard"}),we={class:"d-flex gap-3"},Ce={key:0,class:"text-center py-16 font-mono text-dim",style:{"letter-spacing":"2px"}},ze={key:0,class:"px-5 py-3 font-mono",style:{"font-size":"10px","letter-spacing":"1.5px",color:"var(--text-dim)","border-bottom":"1px solid var(--navy-border)",background:"rgba(255,107,26,0.03)"}},Se={style:{color:"var(--orange)"}},Ue={class:"font-mono text-dim"},je=["onClick"],Be={key:0},De={class:"d-flex justify-end gap-3 mt-4"},Ie={class:"d-flex gap-3 mb-4",style:{"flex-wrap":"wrap"}},$e={class:"db-import-list"},Te=["onClick"],he={style:{flex:"1","min-width":"0"}},Ne={class:"font-head",style:{"font-size":"14px","font-weight":"700",color:"var(--text-bright)"}},_e={class:"font-mono text-dim",style:{"font-size":"10px","letter-spacing":"1px","margin-top":"2px"}},Re={key:0,class:"text-center pa-8 font-mono text-dim",style:{"letter-spacing":"1px"}},Ee={class:"d-flex justify-space-between align-center mt-5"},Le={class:"font-mono text-dim",style:{"font-size":"11px"}},Fe={class:"d-flex gap-3"},Ge={style:{"font-size":"14px",color:"var(--text)","margin-bottom":"24px"}},Ae={style:{color:"var(--text-bright)"}},Me={class:"d-flex justify-end gap-3"},Xe={style:{background:"var(--navy-mid)",border:"1px solid var(--orange)",color:"var(--orange)","font-family":"var(--font-mono)","font-size":"11px","letter-spacing":"2px",padding:"12px 20px"}},Oe=Y({__name:"index",setup(S){const R=re(),{currentReport:f,sevCounts:U,addBevinding:ee,deleteBevinding:te,dbBevindingen:E}=xe(),A=["nvt","kritiek","hoog","gemiddeld","laag","informatief"],M=["open","dicht"],X=[{title:"Webapplicatie",value:"webapplicatie"},{title:"Laptop",value:"laptop"},{title:"Interne Infrastructuur",value:"interne-infrastructuur"},{title:"Externe Infrastructuur",value:"externe-infrastructuur"},{title:"Red Teaming",value:"red-teaming"},{title:"Code Review",value:"code-review"},{title:"Cloud",value:"cloud"}],O=s=>{var e;return((e=X.find(u=>u.value===s))==null?void 0:e.title)??s},k=x(!1),v=Q({titel:"",severiteit:"nvt",status:"open"});function le(s){R.push("/bevindingen/"+s)}function ne(){v.titel.trim()&&(ee(v.titel.trim(),v.severiteit,v.status),k.value=!1,v.titel="")}const w=x(!1),$=x(null),T=x(!1);function oe(s){$.value=s,w.value=!0}function ae(){$.value&&te($.value.id),w.value=!1,T.value=!0}const C=x(!1),j=x(""),B=x("all"),r=Q(new Set),h=x(!1),L=x(0),H=ge(()=>{let s=B.value==="all"?E.value:E.value.filter(e=>e.categorie===B.value);if(j.value.trim()){const e=j.value.trim().toLowerCase();s=s.filter(u=>u.titel.toLowerCase().includes(e))}return s});function K(s){r.has(s)?r.delete(s):r.add(s)}function ie(){if(!f.value)return;let s=0;r.forEach(e=>{const u=E.value.find(l=>l.id===e);if(!u)return;const y=f.value.bevindingen.reduce((l,i)=>Math.max(l,i.id),0);f.value.bevindingen.push({id:y+1,titel:u.titel,severiteit:"nvt",status:"open",checked:!1,referentie:"",beschrijving:u.beschrijving,stappen:u.stappen,risico:u.risico,aanbeveling:u.aanbeveling,fotos:[]}),s++}),L.value=s,r.clear(),C.value=!1,h.value=!0}return(s,e)=>{const u=se,y=ke;return p(),g("div",null,[n(u,null,{title:a(()=>[...e[21]||(e[21]=[d("BEVINDINGEN ",-1),t("span",{class:"accent"},"// ",-1),d("Overzicht",-1)])]),subtitle:a(()=>[...e[22]||(e[22]=[d("Klik op een titel voor details · Severiteit per bevinding",-1)])]),actions:a(()=>[t("div",we,[n(b,{class:"btn-outline-orange",size:"small","prepend-icon":"mdi-database-import",onClick:e[0]||(e[0]=l=>C.value=!0)},{default:a(()=>[...e[23]||(e[23]=[d(" Importeer uit Database ",-1)])]),_:1}),n(b,{class:"btn-outline-orange",size:"small","prepend-icon":"mdi-plus",onClick:e[1]||(e[1]=l=>k.value=!0)},{default:a(()=>[...e[24]||(e[24]=[d(" Nieuwe Bevinding ",-1)])]),_:1})])]),_:1}),n(ue,{class:"mb-6","no-gutters":""},{default:a(()=>[n(D,{cols:"12",sm:"",class:"pr-2"},{default:a(()=>[n(y,{label:"Kritiek",value:o(U).kritiek,color:"#ff6b7a"},null,8,["value"])]),_:1}),n(D,{cols:"12",sm:"",class:"px-2"},{default:a(()=>[n(y,{label:"Hoog",value:o(U).hoog,color:"#ff8c42"},null,8,["value"])]),_:1}),n(D,{cols:"12",sm:"",class:"px-2"},{default:a(()=>[n(y,{label:"Gemiddeld",value:o(U).gemiddeld,color:"#ffd740"},null,8,["value"])]),_:1}),n(D,{cols:"12",sm:"",class:"px-2"},{default:a(()=>[n(y,{label:"Laag",value:o(U).laag,color:"#40c4ff"},null,8,["value"])]),_:1}),n(D,{cols:"12",sm:"",class:"pl-2"},{default:a(()=>[n(y,{label:"Informatief",value:o(U).informatief,color:"#b388ff"},null,8,["value"])]),_:1})]),_:1}),o(f)?(p(),W(N,{key:1,elevation:"0"},{default:a(()=>{var l;return[(l=o(f).testSoorten)!=null&&l.length&&o(f).bevindingen.length?(p(),g("div",ze,[e[25]||(e[25]=d(" ▸ Bevindingen automatisch geladen op basis van: ",-1)),t("span",Se,m(o(f).testSoorten.map(i=>O(i)).join(", ")),1),e[26]||(e[26]=d(" — verander de pentest soort in ",-1)),t("span",{class:"finding-link",style:{"font-size":"10px"},onClick:e[2]||(e[2]=i=>o(R).push("/statisch"))},"Statische Data"),e[27]||(e[27]=d(" om de lijst bij te werken ",-1))])):_("",!0),n(pe,null,{default:a(()=>[e[30]||(e[30]=t("thead",null,[t("tr",null,[t("th",{style:{width:"50px"}},"#"),t("th",null,"Titel"),t("th",{style:{width:"170px"}},"Severiteit"),t("th",{style:{width:"130px"}},"Status"),t("th",{style:{width:"110px","text-align":"center"}},"Gecontroleerd"),t("th",{style:{width:"100px"}},"Referentie"),t("th",{style:{width:"54px","text-align":"center"}},"Del")])],-1)),t("tbody",null,[(p(!0),g(q,null,J(o(f).bevindingen,i=>(p(),g("tr",{key:i.id},[t("td",Ue,m(String(i.id).padStart(2,"0")),1),t("td",null,[t("span",{class:"finding-link",onClick:c=>le(i.id)},m(i.titel),9,je)]),t("td",{onClick:e[3]||(e[3]=z(()=>{},["stop"]))},[n(I,{modelValue:i.severiteit,"onUpdate:modelValue":c=>i.severiteit=c,items:A,density:"compact",variant:"plain","hide-details":"",style:{"font-family":"var(--font-mono)","font-size":"12px","min-width":"130px"}},null,8,["modelValue","onUpdate:modelValue"])]),t("td",{onClick:e[4]||(e[4]=z(()=>{},["stop"]))},[n(I,{modelValue:i.status,"onUpdate:modelValue":c=>i.status=c,items:M,density:"compact",variant:"plain","hide-details":"",style:{"font-family":"var(--font-mono)","font-size":"12px","min-width":"90px"}},null,8,["modelValue","onUpdate:modelValue"])]),t("td",{style:{"text-align":"center"},onClick:e[5]||(e[5]=z(()=>{},["stop"]))},[n(P,{modelValue:i.checked,"onUpdate:modelValue":c=>i.checked=c,density:"compact","hide-details":"",color:"primary",style:{"justify-content":"center"}},null,8,["modelValue","onUpdate:modelValue"])]),t("td",{onClick:e[6]||(e[6]=z(()=>{},["stop"]))},[n(G,{modelValue:i.referentie,"onUpdate:modelValue":c=>i.referentie=c,density:"compact",variant:"plain",placeholder:"p. —","hide-details":"",style:{"font-size":"13px","max-width":"85px"}},null,8,["modelValue","onUpdate:modelValue"])]),t("td",{style:{"text-align":"center"},onClick:e[7]||(e[7]=z(()=>{},["stop"]))},[n(b,{icon:"",size:"x-small",class:"btn-danger",title:"Verwijder bevinding",onClick:c=>oe(i)},{default:a(()=>[n(me,{size:"14"},{default:a(()=>[...e[28]||(e[28]=[d("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])])]))),128)),o(f).bevindingen.length?_("",!0):(p(),g("tr",Be,[...e[29]||(e[29]=[t("td",{colspan:"7",class:"text-center pa-10 font-mono text-dim",style:{"letter-spacing":"2px"}}," Geen bevindingen — selecteer een pentest soort in Statische Data of voeg handmatig toe ",-1)])]))])]),_:1})]}),_:1})):(p(),g("div",Ce," Geen rapport geselecteerd — ga naar Dashboard en klik op een rapport. ")),n(F,{modelValue:o(k),"onUpdate:modelValue":e[12]||(e[12]=l=>V(k)?k.value=l:null),"max-width":"480"},{default:a(()=>[n(N,{class:"pa-8",elevation:"0"},{default:a(()=>[e[33]||(e[33]=t("div",{class:"page-title mb-6"},"◉ Nieuwe Bevinding",-1)),e[34]||(e[34]=t("div",{class:"field-label mb-2"},"Titel",-1)),n(G,{modelValue:o(v).titel,"onUpdate:modelValue":e[8]||(e[8]=l=>o(v).titel=l),placeholder:"Bijv. XML External Entity (XXE)",class:"mb-4","hide-details":""},null,8,["modelValue"]),e[35]||(e[35]=t("div",{class:"field-label mb-2"},"Severiteit",-1)),n(I,{modelValue:o(v).severiteit,"onUpdate:modelValue":e[9]||(e[9]=l=>o(v).severiteit=l),items:A,class:"mb-4","hide-details":""},null,8,["modelValue"]),e[36]||(e[36]=t("div",{class:"field-label mb-2"},"Status",-1)),n(I,{modelValue:o(v).status,"onUpdate:modelValue":e[10]||(e[10]=l=>o(v).status=l),items:M,class:"mb-4","hide-details":""},null,8,["modelValue"]),t("div",De,[n(b,{class:"btn-outline-orange",onClick:e[11]||(e[11]=l=>k.value=!1)},{default:a(()=>[...e[31]||(e[31]=[d("Annuleren",-1)])]),_:1}),n(b,{class:"btn-orange",onClick:ne},{default:a(()=>[...e[32]||(e[32]=[d("Toevoegen",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue"]),n(F,{modelValue:o(C),"onUpdate:modelValue":e[16]||(e[16]=l=>V(C)?C.value=l:null),"max-width":"720"},{default:a(()=>[n(N,{class:"pa-8",elevation:"0"},{default:a(()=>[e[39]||(e[39]=t("div",{class:"page-title mb-2"},"◈ Importeer uit Finding Database",-1)),e[40]||(e[40]=t("p",{class:"font-mono text-dim mb-5",style:{"font-size":"11px","letter-spacing":"1px"}}," Selecteer bevindingen om toe te voegen aan dit rapport ",-1)),t("div",Ie,[n(G,{modelValue:o(j),"onUpdate:modelValue":e[13]||(e[13]=l=>V(j)?j.value=l:null),placeholder:"Zoek op naam...","prepend-inner-icon":"mdi-magnify",clearable:"","hide-details":"",density:"compact",style:{"max-width":"260px"}},null,8,["modelValue"]),n(I,{modelValue:o(B),"onUpdate:modelValue":e[14]||(e[14]=l=>V(B)?B.value=l:null),items:[{title:"Alle categorieën",value:"all"},...X],"item-title":"title","item-value":"value",density:"compact","hide-details":"",style:{"max-width":"220px"}},null,8,["modelValue","items"])]),t("div",$e,[(p(!0),g(q,null,J(o(H),l=>(p(),g("div",{key:l.id,class:ve(["db-import-row",{"db-import-row--selected":o(r).has(l.id)}]),onClick:i=>K(l.id)},[n(P,{"model-value":o(r).has(l.id),density:"compact","hide-details":"",color:"primary",style:{"flex-shrink":"0"},onClick:z(i=>K(l.id),["stop"])},null,8,["model-value","onClick"]),t("div",he,[t("div",Ne,m(l.titel),1),t("div",_e,m(O(l.categorie)),1)]),o(r).has(l.id)?(p(),W(fe,{key:0,size:"x-small",style:{background:"rgba(255,107,26,0.2)",color:"var(--orange)",border:"1px solid rgba(255,107,26,0.4)"}},{default:a(()=>[...e[37]||(e[37]=[d(" geselecteerd ",-1)])]),_:1})):_("",!0)],10,Te))),128)),o(H).length?_("",!0):(p(),g("div",Re," Geen bevindingen gevonden "))]),t("div",Ee,[t("span",Le,m(o(r).size)+" geselecteerd",1),t("div",Fe,[n(b,{class:"btn-outline-orange",onClick:e[15]||(e[15]=l=>{C.value=!1,o(r).clear()})},{default:a(()=>[...e[38]||(e[38]=[d("Annuleren",-1)])]),_:1}),n(b,{class:"btn-orange",disabled:!o(r).size,onClick:ie},{default:a(()=>[d(" Importeren ("+m(o(r).size)+") ",1)]),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"]),n(F,{modelValue:o(w),"onUpdate:modelValue":e[18]||(e[18]=l=>V(w)?w.value=l:null),"max-width":"420"},{default:a(()=>[n(N,{class:"pa-8",elevation:"0",style:{"border-top":"3px solid #ff3d57 !important"}},{default:a(()=>{var l;return[e[45]||(e[45]=t("div",{class:"page-title mb-4",style:{color:"#ff3d57"}},"⚠ Bevinding Verwijderen",-1)),t("p",Ge,[e[41]||(e[41]=d(" Weet je zeker dat je ",-1)),t("strong",Ae,m((l=o($))==null?void 0:l.titel),1),e[42]||(e[42]=d(" wilt verwijderen? Dit kan niet ongedaan worden gemaakt. ",-1))]),t("div",Me,[n(b,{class:"btn-outline-orange",onClick:e[17]||(e[17]=i=>w.value=!1)},{default:a(()=>[...e[43]||(e[43]=[d("Annuleren",-1)])]),_:1}),n(b,{class:"btn-danger",style:{"font-family":"var(--font-head)","font-weight":"700","letter-spacing":"2px"},onClick:ae},{default:a(()=>[...e[44]||(e[44]=[d(" Verwijderen ",-1)])]),_:1})])]}),_:1})]),_:1},8,["modelValue"]),n(Z,{modelValue:o(h),"onUpdate:modelValue":e[19]||(e[19]=l=>V(h)?h.value=l:null),timeout:2500,location:"bottom right",color:"transparent",elevation:"0"},{default:a(()=>[t("div",Xe," ✓ "+m(o(L))+" bevinding"+m(o(L)!==1?"en":"")+" toegevoegd ",1)]),_:1},8,["modelValue"]),n(Z,{modelValue:o(T),"onUpdate:modelValue":e[20]||(e[20]=l=>V(T)?T.value=l:null),timeout:2e3,location:"bottom right",color:"transparent",elevation:"0"},{default:a(()=>[...e[46]||(e[46]=[t("div",{style:{background:"var(--navy-mid)",border:"1px solid #ff3d57",color:"#ff3d57","font-family":"var(--font-mono)","font-size":"11px","letter-spacing":"2px",padding:"12px 20px"}}," ✓ Bevinding verwijderd ",-1)])]),_:1},8,["modelValue"])])}}}),Ze=ce(Oe,[["__scopeId","data-v-3f6e8c3c"]]);export{Ze as default};
