import{_ as $e}from"./BP5qj2Nh.js";import{u as et}from"./Drcv-Wji.js";import{a5 as tt,d as nt,y as ae,B as y,C as E,M as A,T as ot,z as H,a6 as it,N as Ee,L as Re,R as Ne,g as se,x as re,D as S,O as xe,_ as at}from"./DG-Bmc7c.js";function st(){async function le(t){var we,Ce,ye;const{Document:Y,Packer:T,Paragraph:i,TextRun:r,HeadingLevel:k,AlignmentType:R,Table:P,TableRow:o,TableCell:Z,WidthType:w,BorderStyle:c,ShadingType:Se,PageBreak:Te,TableOfContents:ke,PageNumber:ze,Footer:Ie,ImageRun:Le,convertInchesToTwip:q}=await tt(async()=>{const{Document:e,Packer:n,Paragraph:a,TextRun:b,HeadingLevel:l,AlignmentType:p,Table:_,TableRow:ie,TableCell:j,WidthType:X,BorderStyle:v,ShadingType:x,PageBreak:Xe,TableOfContents:Ye,PageNumber:Ze,Footer:qe,ImageRun:Je,convertInchesToTwip:Qe}=await import("./CgmmyUzV.js");return{Document:e,Packer:n,Paragraph:a,TextRun:b,HeadingLevel:l,AlignmentType:p,Table:_,TableRow:ie,TableCell:j,WidthType:X,BorderStyle:v,ShadingType:x,PageBreak:Xe,TableOfContents:Ye,PageNumber:Ze,Footer:qe,ImageRun:Je,convertInchesToTwip:Qe}},[],import.meta.url),d="FF6B1A",B="0F1629",ce="FFFFFF",u="222222",U="6B7FA3",W="F4F6FA",_e="FFFFFF",M="D0D8E8",de=["kritiek","hoog","gemiddeld","laag","informatief","nvt"],ue={kritiek:"Kritiek",hoog:"Hoog",gemiddeld:"Gemiddeld",laag:"Laag",informatief:"Informatief",nvt:"N.V.T."},ge={kritiek:"C0392B",hoog:"A04000",gemiddeld:"7D6608",laag:"1A5276",informatief:"6C3483",nvt:"888888"},Ae=new Date().toLocaleDateString("nl-NL",{day:"2-digit",month:"long",year:"numeric"}),D=q(1),fe=q(8.27),J=fe-D*2,z=(e,n={})=>new r({text:e,font:"Calibri",size:22,color:u,...n}),I=e=>new i({children:[new r({text:e,font:"Calibri",bold:!0,size:40,color:d})],heading:k.HEADING_1,spacing:{before:400,after:200},border:{bottom:{style:c.SINGLE,size:6,color:d}}}),Q=e=>new i({children:[new r({text:e,font:"Calibri",bold:!0,size:28,color:u})],heading:k.HEADING_2,spacing:{before:300,after:140}}),G=e=>new i({children:[new r({text:e,font:"Calibri",bold:!0,size:24,color:d})],heading:k.HEADING_3,spacing:{before:240,after:100}}),h=e=>new i({children:[z(e||"—")],spacing:{after:100}}),g=(e,n)=>new i({children:[z(e+": ",{bold:!0}),z(n||"—")],spacing:{after:80}}),N=()=>new i({children:[new Te],spacing:{after:0}}),C=()=>new i({children:[],spacing:{after:120}}),$=e=>(e||"").split(`
`).filter(Boolean).map(n=>new i({children:[z(n)],spacing:{after:80}})),pe=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"",ee=e=>{const n=e.reduce((l,p)=>l+p,0),a=e.map(l=>Math.round(l/n*J)),b=J-a.reduce((l,p)=>l+p,0);return a[a.length-1]+=b,a},L=(e,n,a,b,l=!1,p=20,_=R.LEFT)=>new Z({children:[new i({children:[new r({text:e,font:"Calibri",size:p,bold:l,color:b})],alignment:_,spacing:{before:60,after:60}})],shading:{fill:a,type:Se.CLEAR,color:"auto"},width:{size:n,type:w.DXA},margins:{top:80,bottom:80,left:120,right:120}}),V=(e,n)=>L(e,n,d,ce,!0,20),te=(e,n)=>L(e,n,B,ce,!0,20),F=(e,n,a,b=u,l=!1)=>L(n,a,e?W:_e,b,l),Pe={top:{style:c.SINGLE,size:4,color:d},bottom:{style:c.SINGLE,size:4,color:d},left:{style:c.SINGLE,size:4,color:d},right:{style:c.SINGLE,size:4,color:d},insideH:{style:c.SINGLE,size:2,color:M},insideV:{style:c.SINGLE,size:2,color:M}},Be={top:{style:c.SINGLE,size:4,color:B},bottom:{style:c.SINGLE,size:4,color:B},left:{style:c.SINGLE,size:4,color:B},right:{style:c.SINGLE,size:4,color:B},insideH:{style:c.SINGLE,size:2,color:M},insideV:{style:c.SINGLE,size:2,color:M}},he=(e,n,a=Pe)=>new P({width:{size:J,type:w.DXA},columnWidths:n,rows:e,borders:a}),De=t.aanpak?pe(t.aanpak)+" Penetratietest":"Penetratietest",K=[new i({children:[new r({text:"PENTESTRAPPORT",font:"Calibri",bold:!0,size:80,color:d})],alignment:R.CENTER,spacing:{before:1440,after:240}}),new i({children:[new r({text:t.bedrijf,font:"Calibri",bold:!0,size:56,color:u})],alignment:R.CENTER,spacing:{after:120}}),new i({children:[new r({text:De,font:"Calibri",size:28,color:U})],alignment:R.CENTER,spacing:{after:960}}),C(),C(),new i({children:[new r({text:"Datum: "+Ae,font:"Calibri",size:22,color:u})],spacing:{after:60}})];t.pentesters.length&&(K.push(new i({children:[new r({text:"Uitgevoerd door:",font:"Calibri",bold:!0,size:22,color:u})],spacing:{after:40}})),t.pentesters.forEach(e=>{const n=e.naam+(e.functie?" — "+e.functie:"");K.push(new i({children:[new r({text:"  "+n,font:"Calibri",size:22,color:u})],spacing:{after:40}}))})),K.push(N());const Ge=[I("Inhoudsopgave"),new ke("Inhoudsopgave",{hyperlink:!0,headingStyleRange:"1-3",stylesWithLevels:[{styleName:"Heading 1",level:1},{styleName:"Heading 2",level:2},{styleName:"Heading 3",level:3}]}),N()],Ve=[I("1. Managementsamenvatting"),...t.samenvatting?$(t.samenvatting):[h("—")],N()],me=[...t.bevindingen.filter(e=>e.severiteit!=="nvt").sort((e,n)=>de.indexOf(e.severiteit)-de.indexOf(n.severiteit)),...t.bevindingen.filter(e=>e.severiteit==="nvt")],f=ee([.06,.36,.2,.18,.2]),Fe=[new o({tableHeader:!0,children:[V("#",f[0]),V("Bevinding",f[1]),V("Severiteit",f[2]),V("Status",f[3]),V("Referentie",f[4])]}),...me.map((e,n)=>{const a=n%2===0;return new o({children:[F(a,String(n+1).padStart(2,"0"),f[0]),F(a,e.titel,f[1]),F(a,ue[e.severiteit]??"—",f[2],ge[e.severiteit]??u,!0),F(a,e.status==="open"?"Open":"Dicht",f[3],e.status==="open"?"C0392B":"1E8449"),F(a,e.referentie||"—",f[4])]})})],Oe=[I("2. Technische Samenvatting"),h("Onderstaande tabel geeft een overzicht van alle bevindingen, gesorteerd op ernst."),C(),he(Fe,f),N()],je={webapplicatie:"Webapplicatie",laptop:"Laptop","interne-infrastructuur":"Interne Infrastructuur","externe-infrastructuur":"Externe Infrastructuur","red-teaming":"Red Teaming","code-review":"Code Review",cloud:"Cloud"},He={kritiek:"Kritiek",hoog:"Hoog",gemiddeld:"Gemiddeld",laag:"Laag",informatief:"Informatief"},m=[I("3. Beschrijving"),Q("3.1 Klantgegevens"),g("Bedrijf",t.bedrijf),g("Contactpersoon",t.contactNaam),g("E-mail",t.contactEmail),g("Telefoon",t.contactTel),C(),Q("3.2 Opdrachtgegevens"),g("Aanpak",t.aanpak?pe(t.aanpak):"—"),g("Risico niveau",t.risicoNiveau?He[t.risicoNiveau]??t.risicoNiveau:"—"),g("Soort pentest",(we=t.testSoorten)!=null&&we.length?t.testSoorten.map(e=>je[e]??e).join(", "):"—"),g("Datum",t.datum),C(),Q("3.3 Pentesters")];t.pentesters.length?t.pentesters.forEach((e,n)=>{m.push(G("Pentester "+(n+1)+": "+e.naam)),m.push(g("Naam",e.naam)),m.push(g("Functie",e.functie)),m.push(g("E-mail",e.email)),m.push(g("Telefoon",e.tel)),m.push(C())}):m.push(h("Geen pentesters geregistreerd.")),m.push(N());const s=[I("4. Bevindingen")],be=me.filter(e=>{var n;return e.beschrijving||e.stappen||e.risico||e.aanbeveling||((n=e.fotos)==null?void 0:n.length)}),O=ee([.25,.25,.25,.25]),ne=ee([.25,.75]);for(const e of be){s.push(N()),s.push(new i({children:[new r({text:e.titel,font:"Calibri",bold:!0,size:36,color:d})],heading:k.HEADING_2,spacing:{before:200,after:200}}));const n=[new o({children:[te("Severiteit",O[0]),L(ue[e.severiteit]??"—",O[1],W,ge[e.severiteit]??u,!0,20),te("Status",O[2]),L(e.status==="open"?"Open":"Dicht",O[3],W,e.status==="open"?"C0392B":"1E8449",!0,20)]})];if(e.referentie&&n.push(new o({children:[te("Referentie",ne[0]),L(e.referentie,ne[1],W,u,!1,20)]})),s.push(he(n,e.referentie?ne:O,Be)),s.push(C()),e.beschrijving&&(s.push(G("Beschrijving")),s.push(h(e.beschrijving))),(e.stappen||(Ce=e.fotos)!=null&&Ce.length)&&(s.push(G("Reproduceerbare stappen voor de klant")),e.stappen&&s.push(...$(e.stappen)),(ye=e.fotos)!=null&&ye.length)){s.push(C()),s.push(new i({children:[z("Screenshots:",{bold:!0})],spacing:{after:100}}));for(const a of e.fotos)try{const b=a.src.split(",")[1],l=(a.src.split(";")[0].split("/")[1]??"png").toLowerCase(),p=atob(b),_=new Uint8Array(p.length);for(let v=0;v<p.length;v++)_[v]=p.charCodeAt(v);const ie=l==="jpg"||l==="jpeg"?"jpg":l==="gif"?"gif":"png",j=await new Promise(v=>{const x=new Image;x.onload=()=>v({w:x.naturalWidth,h:x.naturalHeight}),x.onerror=()=>v({w:400,h:300}),x.src=a.src}),X=Math.min(1,500/j.w);s.push(new i({children:[new Le({data:_.buffer,transformation:{width:Math.round(j.w*X),height:Math.round(j.h*X)},type:ie})],spacing:{after:80}})),s.push(new i({children:[z(a.name,{italics:!0,size:18,color:U})],spacing:{after:120}}))}catch{s.push(h("[Afbeelding: "+a.name+"]"))}}e.risico&&(s.push(G("Risico")),s.push(h(e.risico))),e.aanbeveling&&(s.push(G("Aanbeveling")),s.push(h(e.aanbeveling)))}be.length||s.push(h("Geen bevindingen met details geregistreerd."));const Ue=[N(),I("5. Conclusie"),...t.conclusie?$(t.conclusie):[h("—")]],We=t.bedrijf+" — Vertrouwelijk",Me=new Y({title:"Pentestrapport "+t.bedrijf,description:"Penetratietest rapport voor "+t.bedrijf,styles:{default:{document:{run:{font:"Calibri",size:22,color:u}},heading1:{run:{font:"Calibri",bold:!0,size:40,color:d}},heading2:{run:{font:"Calibri",bold:!0,size:28,color:u}},heading3:{run:{font:"Calibri",bold:!0,size:24,color:d}}}},sections:[{properties:{page:{margin:{top:D,bottom:D,left:D,right:D},size:{width:fe,height:q(11.69)}}},footers:{default:new Ie({children:[new i({children:[new r({text:We,font:"Calibri",size:18,color:U}),new r({children:["		",ze.CURRENT],font:"Calibri",size:18,color:U})],alignment:R.CENTER,spacing:{before:200}})]})},children:[...K,...Ge,...Ve,...Oe,...m,...s,...Ue]}]}),Ke=await T.toBlob(Me),ve=URL.createObjectURL(Ke),oe=document.createElement("a");oe.href=ve,oe.download="Pentestrapport_"+t.bedrijf.replace(/[^a-zA-Z0-9]/g,"_")+"_"+t.datum+".docx",oe.click(),URL.revokeObjectURL(ve)}return{generateDocx:le}}const rt={key:0,class:"text-center py-16 font-mono text-dim",style:{"letter-spacing":"2px"}},lt={class:"d-flex justify-end gap-3"},ct=nt({__name:"conclusie",setup(le){const{currentReport:t}=et(),{generateDocx:Y}=st(),T=se(!1),i=se(!1),r=se(!1);function k(){T.value=!0}async function R(){if(t.value){r.value=!0;try{await Y(t.value),i.value=!0}catch(P){console.error("Rapport genereren mislukt:",P),alert("Rapport genereren mislukt: "+String(P))}finally{r.value=!1}}}return(P,o)=>{const Z=$e;return re(),ae("div",null,[y(Z,null,{title:E(()=>[...o[3]||(o[3]=[S("CONCLUSIE ",-1),H("span",{class:"accent"},"// ",-1),S("Eindoordeel",-1)])]),subtitle:E(()=>[...o[4]||(o[4]=[S("Samenvatting en eindbeoordeling van de pentest",-1)])]),_:1}),A(t)?(re(),ae(ot,{key:1},[o[9]||(o[9]=H("div",{class:"field-label mb-2"},"Conclusie",-1)),y(it,{modelValue:A(t).conclusie,"onUpdate:modelValue":o[0]||(o[0]=w=>A(t).conclusie=w),rows:"16",placeholder:"Schrijf hier de conclusie van de pentest...",style:{"font-size":"15px","line-height":"1.8"},"hide-details":"",class:"mb-6"},null,8,["modelValue"]),H("div",lt,[y(Ee,{class:"btn-orange",onClick:k},{default:E(()=>[y(xe,{class:"mr-2"},{default:E(()=>[...o[5]||(o[5]=[S("mdi-content-save",-1)])]),_:1}),o[6]||(o[6]=S("Opslaan ",-1))]),_:1}),y(Ee,{class:"btn-generate",loading:A(r),onClick:R},{default:E(()=>[y(xe,{class:"mr-2"},{default:E(()=>[...o[7]||(o[7]=[S("mdi-file-word-box",-1)])]),_:1}),o[8]||(o[8]=S("Genereer Rapport ",-1))]),_:1},8,["loading"])])],64)):(re(),ae("div",rt," Geen rapport geselecteerd — ga naar Dashboard en klik op een rapport. ")),y(Ne,{modelValue:A(T),"onUpdate:modelValue":o[1]||(o[1]=w=>Re(T)?T.value=w:null),timeout:2500,location:"bottom right",color:"transparent",elevation:"0"},{default:E(()=>[...o[10]||(o[10]=[H("div",{style:{background:"var(--navy-mid)",border:"1px solid var(--orange)",color:"var(--orange)","font-family":"var(--font-mono)","font-size":"11px","letter-spacing":"2px",padding:"12px 20px"}}," Conclusie opgeslagen ",-1)])]),_:1},8,["modelValue"]),y(Ne,{modelValue:A(i),"onUpdate:modelValue":o[2]||(o[2]=w=>Re(i)?i.value=w:null),timeout:3e3,location:"bottom right",color:"transparent",elevation:"0"},{default:E(()=>[...o[11]||(o[11]=[H("div",{style:{background:"var(--navy-mid)",border:"1px solid #00e676",color:"#00e676","font-family":"var(--font-mono)","font-size":"11px","letter-spacing":"2px",padding:"12px 20px"}}," Rapport gedownload als .docx ",-1)])]),_:1},8,["modelValue"])])}}}),ft=at(ct,[["__scopeId","data-v-15e036d2"]]);export{ft as default};
