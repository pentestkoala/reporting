import{_ as Z}from"./BP5qj2Nh.js";import{d as q,y as p,B as i,C as a,z as t,L as D,M as n,J as E,A as u,T,U as R,Z as g,Q as $,g as c,x as v,N as f,D as r,S as H,Y as J,O as I,a8 as P,a9 as Q,V as S,$ as Y,a6 as j,k as K,a0 as ee,_ as te}from"./DG-Bmc7c.js";import{u as le}from"./Drcv-Wji.js";const ie={class:"d-flex align-center gap-4 mb-5"},ne={class:"font-mono text-dim",style:{"font-size":"11px","letter-spacing":"1px"}},se={class:"section-title mb-3"},ae={class:"font-mono text-dim"},oe=["onClick"],de={key:0,class:"db-expand pa-3 mt-2 mb-1"},re={key:0,class:"mb-3"},ue={style:{"font-size":"13px",color:"var(--text)","line-height":"1.6","white-space":"pre-line"}},pe={key:1,class:"mb-3"},ve={style:{"font-size":"13px",color:"var(--text)","line-height":"1.6","white-space":"pre-line"}},me={key:2,class:"mb-3"},ge={style:{"font-size":"13px",color:"var(--text)","line-height":"1.6"}},fe={key:3},be={style:{"font-size":"13px",color:"var(--text)","line-height":"1.6"}},xe={class:"d-flex justify-center gap-2"},ce={key:0,class:"text-center py-16 font-mono text-dim",style:{"letter-spacing":"2px"}},Ve={class:"page-title mb-6"},ye={class:"d-flex justify-end gap-3 mt-2"},ke={style:{"font-size":"14px",color:"var(--text)","margin-bottom":"24px"}},we={style:{color:"var(--text-bright)"}},je={class:"d-flex justify-end gap-3"},Ce=q({__name:"finding-database",setup(Be){const{dbBevindingen:U,addDbBevinding:F,deleteDbBevinding:L}=le(),b=c(""),V=c(null),m=c(!1),y=c(null),x=c(!1),w=c(null),C=[{title:"Webapplicatie",value:"webapplicatie"},{title:"Laptop",value:"laptop"},{title:"Interne Infrastructuur",value:"interne-infrastructuur"},{title:"Externe Infrastructuur",value:"externe-infrastructuur"},{title:"Red Teaming",value:"red-teaming"},{title:"Code Review",value:"code-review"},{title:"Cloud",value:"cloud"}],B=s=>{let e=U.value.filter(k=>k.categorie===s);if(b.value.trim()){const k=b.value.trim().toLowerCase();e=e.filter(l=>l.titel.toLowerCase().includes(k))}return e},z=K(()=>C.reduce((s,e)=>s+B(e.value).length,0));function O(s){V.value=V.value===s?null:s}const A=()=>({titel:"",categorie:"webapplicatie",beschrijving:"",stappen:"",risico:"",aanbeveling:""}),o=ee(A());function _(){Object.assign(o,A()),y.value=null,m.value=!0}function W(s){Object.assign(o,{titel:s.titel,categorie:s.categorie,beschrijving:s.beschrijving,stappen:s.stappen,risico:s.risico,aanbeveling:s.aanbeveling}),y.value=s.id,m.value=!0}function h(){if(o.titel.trim()){if(y.value){const s=U.value.find(e=>e.id===y.value);s&&Object.assign(s,o)}else F({...o});m.value=!1}}function M(s){w.value=s,x.value=!0}function X(){w.value&&L(w.value.id),x.value=!1}return(s,e)=>{const k=Z;return v(),p("div",null,[i(k,null,{title:a(()=>[...e[13]||(e[13]=[r("FINDING ",-1),t("span",{class:"accent"},"DATABASE",-1)])]),subtitle:a(()=>[...e[14]||(e[14]=[r("Bibliotheek van herbruikbare bevindingen per categorie",-1)])]),actions:a(()=>[i(f,{class:"btn-outline-orange","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=l=>_())},{default:a(()=>[...e[15]||(e[15]=[r(" Bevinding Toevoegen ",-1)])]),_:1})]),_:1}),t("div",ie,[i(E,{modelValue:n(b),"onUpdate:modelValue":e[1]||(e[1]=l=>D(b)?b.value=l:null),placeholder:"Zoek op naam...","prepend-inner-icon":"mdi-magnify",clearable:"","hide-details":"",density:"compact",style:{"max-width":"320px"}},null,8,["modelValue"]),t("span",ne,u(n(z))+" bevinding"+u(n(z)!==1?"en":""),1)]),(v(),p(T,null,R(C,l=>t("div",{key:l.value,class:"mb-8"},[B(l.value).length?(v(),p(T,{key:0},[t("div",se,u(l.title),1),i(S,{elevation:"0"},{default:a(()=>[i(H,null,{default:a(()=>[e[23]||(e[23]=t("thead",null,[t("tr",null,[t("th",{style:{width:"50px"}},"#"),t("th",null,"Titel"),t("th",{style:{width:"120px","text-align":"center"}},"Acties")])],-1)),t("tbody",null,[(v(!0),p(T,null,R(B(l.value),(d,G)=>(v(),p("tr",{key:d.id,class:J(["db-row",{"db-row--open":n(V)===d.id}])},[t("td",ae,u(String(G+1).padStart(2,"0")),1),t("td",null,[t("div",{class:"finding-link",style:{"font-weight":"600"},onClick:N=>O(d.id)},[r(u(d.titel)+" ",1),i(I,{size:"14",style:P([{"margin-left":"6px",color:"var(--text-dim)",transition:"transform 0.2s"},n(V)===d.id?"transform:rotate(90deg)":""])},{default:a(()=>[...e[16]||(e[16]=[r(" mdi-chevron-right ",-1)])]),_:1},8,["style"])],8,oe),n(V)===d.id?(v(),p("div",de,[d.beschrijving?(v(),p("div",re,[e[17]||(e[17]=t("div",{class:"field-label mb-1"},"Beschrijving",-1)),t("p",ue,u(d.beschrijving),1)])):g("",!0),d.stappen?(v(),p("div",pe,[e[18]||(e[18]=t("div",{class:"field-label mb-1"},"Reproduceerbare Stappen",-1)),t("p",ve,u(d.stappen),1)])):g("",!0),d.risico?(v(),p("div",me,[e[19]||(e[19]=t("div",{class:"field-label mb-1"},"Risico",-1)),t("p",ge,u(d.risico),1)])):g("",!0),d.aanbeveling?(v(),p("div",fe,[e[20]||(e[20]=t("div",{class:"field-label mb-1"},"Aanbeveling",-1)),t("p",be,u(d.aanbeveling),1)])):g("",!0)])):g("",!0)]),t("td",{style:{"text-align":"center"},onClick:e[2]||(e[2]=Q(()=>{},["stop"]))},[t("div",xe,[i(f,{icon:"",size:"x-small",class:"btn-outline-orange",title:"Bewerken",onClick:N=>W(d)},{default:a(()=>[i(I,{size:"14"},{default:a(()=>[...e[21]||(e[21]=[r("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"]),i(f,{icon:"",size:"x-small",class:"btn-danger",title:"Verwijderen",onClick:N=>M(d)},{default:a(()=>[i(I,{size:"14"},{default:a(()=>[...e[22]||(e[22]=[r("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])])])],2))),128))])]),_:2},1024)]),_:2},1024)],64)):g("",!0)])),64)),n(z)===0?(v(),p("div",ce,u(n(b)?"Geen resultaten gevonden":"Database is leeg â€” voeg bevindingen toe"),1)):g("",!0),i($,{modelValue:n(m),"onUpdate:modelValue":e[10]||(e[10]=l=>D(m)?m.value=l:null),"max-width":"640"},{default:a(()=>[i(S,{class:"pa-8",elevation:"0"},{default:a(()=>[t("div",Ve,u(n(y)?"Bewerk Bevinding":"Nieuwe Bevinding"),1),e[26]||(e[26]=t("div",{class:"field-label mb-2"},"Titel",-1)),i(E,{modelValue:n(o).titel,"onUpdate:modelValue":e[3]||(e[3]=l=>n(o).titel=l),placeholder:"Bijv. XML External Entity (XXE)",class:"mb-4","hide-details":""},null,8,["modelValue"]),e[27]||(e[27]=t("div",{class:"field-label mb-2"},"Categorie",-1)),i(Y,{modelValue:n(o).categorie,"onUpdate:modelValue":e[4]||(e[4]=l=>n(o).categorie=l),items:C,"item-title":"title","item-value":"value",class:"mb-4","hide-details":""},null,8,["modelValue"]),e[28]||(e[28]=t("div",{class:"field-label mb-2"},"Beschrijving",-1)),i(j,{modelValue:n(o).beschrijving,"onUpdate:modelValue":e[5]||(e[5]=l=>n(o).beschrijving=l),rows:"3",placeholder:"Beschrijf de bevinding...",class:"mb-4","hide-details":""},null,8,["modelValue"]),e[29]||(e[29]=t("div",{class:"field-label mb-2"},"Reproduceerbare Stappen",-1)),i(j,{modelValue:n(o).stappen,"onUpdate:modelValue":e[6]||(e[6]=l=>n(o).stappen=l),rows:"4",placeholder:"Stap 1: ...",class:"mb-4","hide-details":""},null,8,["modelValue"]),e[30]||(e[30]=t("div",{class:"field-label mb-2"},"Risico",-1)),i(j,{modelValue:n(o).risico,"onUpdate:modelValue":e[7]||(e[7]=l=>n(o).risico=l),rows:"2",placeholder:"Wat zijn de mogelijke gevolgen?",class:"mb-4","hide-details":""},null,8,["modelValue"]),e[31]||(e[31]=t("div",{class:"field-label mb-2"},"Aanbeveling",-1)),i(j,{modelValue:n(o).aanbeveling,"onUpdate:modelValue":e[8]||(e[8]=l=>n(o).aanbeveling=l),rows:"2",placeholder:"Welke maatregelen worden aanbevolen?",class:"mb-4","hide-details":""},null,8,["modelValue"]),t("div",ye,[i(f,{class:"btn-outline-orange",onClick:e[9]||(e[9]=l=>m.value=!1)},{default:a(()=>[...e[24]||(e[24]=[r("Annuleren",-1)])]),_:1}),i(f,{class:"btn-orange",onClick:h},{default:a(()=>[...e[25]||(e[25]=[r("Opslaan",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue"]),i($,{modelValue:n(x),"onUpdate:modelValue":e[12]||(e[12]=l=>D(x)?x.value=l:null),"max-width":"420"},{default:a(()=>[i(S,{class:"pa-8",elevation:"0",style:{"border-top":"3px solid #ff3d57 !important"}},{default:a(()=>{var l;return[e[36]||(e[36]=t("div",{class:"page-title mb-4",style:{color:"#ff3d57"}},"Bevinding Verwijderen",-1)),t("p",ke,[e[32]||(e[32]=r(" Weet je zeker dat je ",-1)),t("strong",we,u((l=n(w))==null?void 0:l.titel),1),e[33]||(e[33]=r(" wilt verwijderen? ",-1))]),t("div",je,[i(f,{class:"btn-outline-orange",onClick:e[11]||(e[11]=d=>x.value=!1)},{default:a(()=>[...e[34]||(e[34]=[r("Annuleren",-1)])]),_:1}),i(f,{class:"btn-danger",style:{"font-family":"var(--font-head)","font-weight":"700","letter-spacing":"2px"},onClick:X},{default:a(()=>[...e[35]||(e[35]=[r("Verwijderen",-1)])]),_:1})])]}),_:1})]),_:1},8,["modelValue"])])}}}),Ie=te(Ce,[["__scopeId","data-v-36b243e3"]]);export{Ie as default};
