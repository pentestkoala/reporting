import{g,k as b}from"./DG-Bmc7c.js";const A=[{id:1,bedrijf:"Acme B.V.",contactNaam:"Jan de Vries",contactEmail:"jan.devries@acme.nl",contactTel:"+31 6 12345678",aanpak:"graybox",testSoorten:["webapplicatie","cloud"],risicoNiveau:"hoog",status:"lopend",datum:"2025-02-10",samenvatting:"Tijdens de graybox pentest van Acme B.V. zijn in totaal 8 bevindingen geïdentificeerd, waarvan 2 kritiek en 3 hoog. De meest kritieke bevinding betreft een SQL Injection kwetsbaarheid in het inlogformulier waarmee een aanvaller volledige databasetoegang kan verkrijgen.",conclusie:"De algehele beveiligingsstatus van de Acme applicatie wordt beoordeeld als onvoldoende. De gevonden kritieke kwetsbaarheden dienen met hoge prioriteit te worden verholpen.",pentesters:[{naam:"Alice Smit",functie:"Senior Pentester",email:"alice@redteam.nl",tel:"+31 6 11111111"},{naam:"Bob Jansen",functie:"Pentester",email:"bob@redteam.nl",tel:"+31 6 22222222"}],bevindingen:[{id:1,titel:"SQL Injection",severiteit:"kritiek",status:"open",checked:!1,referentie:"p. 8",beschrijving:"Een SQL Injection kwetsbaarheid is aangetroffen in het inlogformulier op /login. Door het invoeren van een speciaal geconstrueerde payload is het mogelijk de authenticatie te omzeilen.",stappen:`Stap 1: Navigeer naar /login
Stap 2: Vul als gebruikersnaam 'admin' in
Stap 3: Vul als wachtwoord: ' OR '1'='1
Stap 4: Klik op Inloggen`,risico:"Volledige databasetoegang. Alle gebruikersdata en wachtwoordhashes uitleesbaar.",aanbeveling:"Gebruik prepared statements. Implementeer input validatie. Overweeg een WAF.",fotos:[]},{id:2,titel:"Cross-Site Scripting (XSS)",severiteit:"hoog",status:"open",checked:!0,referentie:"p. 12",beschrijving:"Stored XSS in het berichtenmodule. Gebruikersinvoer wordt niet gesanitiseerd opgeslagen.",stappen:`Stap 1: Log in
Stap 2: Ga naar berichten
Stap 3: Voer in: <script>alert(document.cookie)<\/script>`,risico:"Sessiecookies stelen, accountovername.",aanbeveling:"Output encoding. CSP header implementeren.",fotos:[]},{id:3,titel:"Cross-Site Request Forgery (CSRF)",severiteit:"gemiddeld",status:"open",checked:!1,referentie:"p. 16",beschrijving:"CSRF-tokens ontbreken op kritieke endpoints.",stappen:`Stap 1: Maak verborgen form met POST naar /api/change-password
Stap 2: Stuur link naar ingelogde gebruiker`,risico:"Acties namens gebruikers zonder medeweten.",aanbeveling:"CSRF-tokens implementeren. SameSite cookie attribuut.",fotos:[]},{id:4,titel:"Server-Side Template Injection",severiteit:"kritiek",status:"open",checked:!1,referentie:"p. 20",beschrijving:"SSTI in het rapportgeneratie-endpoint.",stappen:`Stap 1: /api/report?name={{7*7}}
Stap 2: Observeer output '49'`,risico:"Remote Code Execution. Volledige servercompromis.",aanbeveling:"Nooit gebruikersinvoer in templates. Gebruik sandbox-modus.",fotos:[]},{id:5,titel:"Path Traversal",severiteit:"hoog",status:"dicht",checked:!0,referentie:"p. 24",beschrijving:"Path traversal in het download-endpoint.",stappen:"GET /download?file=../../../../etc/passwd",risico:"Systeembestanden uitlezen, private keys.",aanbeveling:"Whitelist van toegestane bestanden. Canonical path validatie.",fotos:[]},{id:6,titel:"Local File Inclusion (LFI)",severiteit:"gemiddeld",status:"open",checked:!1,referentie:"p. 27",beschrijving:"LFI in de taalparameter.",stappen:"/?lang=../../../../etc/passwd%00",risico:"Lokale bestanden inzien. Escalatie naar RCE mogelijk.",aanbeveling:"Geen gebruikersinvoer voor bestandspaden. Whitelist.",fotos:[]},{id:7,titel:"File Upload Vulnerability",severiteit:"hoog",status:"open",checked:!1,referentie:"p. 36",beschrijving:"Geen server-side bestandstype validatie.",stappen:"Upload shell.php.jpg → /uploads/shell.php.jpg?cmd=id",risico:"RCE via webshell.",aanbeveling:"MIME-type en magic bytes validatie. Opslaan buiten webroot.",fotos:[]},{id:8,titel:"HTTP Request Smuggling",severiteit:"gemiddeld",status:"open",checked:!1,referentie:"p. 40",beschrijving:"TE.CL request smuggling in de proxy.",stappen:"Conflicterende Content-Length en Transfer-Encoding headers.",risico:"Requests kapen, beveiligingscontroles omzeilen.",aanbeveling:"Update software. HTTP/2 end-to-end.",fotos:[]},{id:9,titel:"Outdated Software",severiteit:"informatief",status:"open",checked:!1,referentie:"p. 33",beschrijving:"Apache 2.4.49 en OpenSSL 1.0.2 — bekende CVE's.",stappen:"Server header: Apache/2.4.49 → CVE-2021-41773",risico:"CVSS 9.8. Kwetsbaarheden uitbuitbaar.",aanbeveling:"Update alle software. Patchmanagement implementeren.",fotos:[]},{id:10,titel:"HTTP Security Headers",severiteit:"laag",status:"open",checked:!0,referentie:"p. 30",beschrijving:"CSP, X-Frame-Options en HSTS ontbreken.",stappen:"Inspecteer response headers.",risico:"Clickjacking, MIME-sniffing.",aanbeveling:"Alle security headers implementeren.",fotos:[]}]},{id:2,bedrijf:"TechNova N.V.",contactNaam:"Petra Bakker",contactEmail:"petra.bakker@technova.nl",contactTel:"+31 20 1234567",aanpak:"blackbox",testSoorten:["interne-infrastructuur"],risicoNiveau:"kritiek",status:"afgerond",datum:"2025-01-15",samenvatting:"De blackbox pentest van TechNova N.V. resulteerde in 5 bevindingen. De Active Directory bevat misconfiguraties die privilege escalation mogelijk maken.",conclusie:"De netwerkinfrastructuur vertoont typische zwaktes. AD-configuratie verdient onmiddellijke aandacht.",pentesters:[{naam:"Carol de Wit",functie:"Lead Pentester",email:"carol@redteam.nl",tel:"+31 6 33333333"}],bevindingen:[{id:1,titel:"SQL Injection",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"N.v.t.",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:2,titel:"Cross-Site Scripting (XSS)",severiteit:"laag",status:"dicht",checked:!0,referentie:"p. 5",beschrijving:"Reflected XSS in zoekfunctie intern portaal.",stappen:"",risico:"",aanbeveling:"Output encoding.",fotos:[]},{id:3,titel:"Cross-Site Request Forgery (CSRF)",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:4,titel:"Server-Side Template Injection",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:5,titel:"Path Traversal",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:6,titel:"Local File Inclusion (LFI)",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:7,titel:"File Upload Vulnerability",severiteit:"hoog",status:"open",checked:!1,referentie:"p. 9",beschrijving:"Unrestricted file upload op medewerkersportaal.",stappen:"",risico:"RCE.",aanbeveling:"Valideer bestandstypen.",fotos:[]},{id:8,titel:"HTTP Request Smuggling",severiteit:"gemiddeld",status:"open",checked:!1,referentie:"p. 14",beschrijving:"CL.TE smuggling op Nginx.",stappen:"",risico:"Session hijacking.",aanbeveling:"Update Nginx.",fotos:[]},{id:9,titel:"Outdated Software",severiteit:"kritiek",status:"open",checked:!1,referentie:"p. 17",beschrijving:"Windows Server 2008 R2. CVE-2019-0708 (BlueKeep).",stappen:"",risico:"CVSS 9.8 — wormbare RCE via RDP.",aanbeveling:"Migreer naar Windows Server 2022.",fotos:[]},{id:10,titel:"HTTP Security Headers",severiteit:"informatief",status:"dicht",checked:!0,referentie:"p. 19",beschrijving:"Hersteld na eerste rapportage.",stappen:"",risico:"",aanbeveling:"",fotos:[]}]},{id:3,bedrijf:"SecureBank B.V.",contactNaam:"Dirk van Loon",contactEmail:"d.vanloon@securebank.nl",contactTel:"+31 10 9876543",aanpak:"whitebox",testSoorten:["webapplicatie","code-review"],risicoNiveau:"gemiddeld",status:"concept",datum:"2025-02-20",samenvatting:"Whitebox pentest van SecureBank B.V. Source code analyse gecombineerd met black-box testing. Rapport in conceptfase.",conclusie:"",pentesters:[{naam:"Alice Smit",functie:"Senior Pentester",email:"alice@redteam.nl",tel:"+31 6 11111111"},{naam:"Erik Visser",functie:"Code Reviewer",email:"erik@redteam.nl",tel:"+31 6 44444444"}],bevindingen:[{id:1,titel:"SQL Injection",severiteit:"kritiek",status:"open",checked:!1,referentie:"p. 6",beschrijving:"Blind SQL injection via datum-parameter.",stappen:"",risico:"Alle transactiedata.",aanbeveling:"Prepared statements.",fotos:[]},{id:2,titel:"Cross-Site Scripting (XSS)",severiteit:"hoog",status:"open",checked:!1,referentie:"p. 10",beschrijving:"DOM-based XSS via hash fragment.",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:3,titel:"Cross-Site Request Forgery (CSRF)",severiteit:"hoog",status:"open",checked:!1,referentie:"p. 13",beschrijving:"CSRF op overboeking endpoint.",stappen:"",risico:"Ongeautoriseerde geldtransfers.",aanbeveling:"CSRF tokens.",fotos:[]},{id:4,titel:"Server-Side Template Injection",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:5,titel:"Path Traversal",severiteit:"gemiddeld",status:"open",checked:!1,referentie:"p. 16",beschrijving:"Config bestanden leesbaar.",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:6,titel:"Local File Inclusion (LFI)",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:7,titel:"File Upload Vulnerability",severiteit:"laag",status:"open",checked:!1,referentie:"p. 20",beschrijving:"Geen bestandsgrootte limiet.",stappen:"",risico:"DoS via grote uploads.",aanbeveling:"Max bestandsgrootte instellen.",fotos:[]},{id:8,titel:"HTTP Request Smuggling",severiteit:"nvt",status:"dicht",checked:!0,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]},{id:9,titel:"Outdated Software",severiteit:"informatief",status:"open",checked:!1,referentie:"p. 22",beschrijving:"jQuery 1.11.1.",stappen:"",risico:"",aanbeveling:"Upgrade jQuery 3.x+",fotos:[]},{id:10,titel:"HTTP Security Headers",severiteit:"informatief",status:"open",checked:!1,referentie:"p. 24",beschrijving:"HSTS preload ontbreekt.",stappen:"",risico:"",aanbeveling:"HSTS preload toevoegen.",fotos:[]}]}],E=[{id:1,titel:"SQL Injection",categorie:"webapplicatie",beschrijving:"SQL injection stelt een aanvaller in staat database-queries te manipuleren via ongesanitiseerde invoer in webformulieren of URL-parameters.",stappen:`Stap 1: Identificeer invoervelden die database-queries beïnvloeden
Stap 2: Test met payload: ' OR '1'='1
Stap 3: Gebruik sqlmap voor automatische detectie en exploitatie`,risico:"Volledige databasecompromis, datalekken van gevoelige klantinformatie, authenticatie-bypass, in ernstige gevallen RCE via xp_cmdshell.",aanbeveling:"Gebruik prepared statements / parameterized queries. Implementeer input validatie en output encoding. Beperk databaserechten (least privilege). Overweeg een WAF."},{id:2,titel:"Cross-Site Scripting (XSS)",categorie:"webapplicatie",beschrijving:"XSS maakt het mogelijk kwaadaardige JavaScript te injecteren die in de browser van slachtoffers wordt uitgevoerd.",stappen:`Stap 1: Zoek invoervelden die output reflecteren
Stap 2: Test: <script>alert(1)<\/script>
Stap 3: Probeer stored variant via persistent opslag`,risico:"Sessiecookies stelen, keyloggers injecteren, phishing via DOM-manipulatie, accountovername.",aanbeveling:"Output encoding (HTML entities). Content Security Policy (CSP) header. HTTPOnly en Secure cookie flags. Input sanitisatie server-side."},{id:3,titel:"Broken Authentication",categorie:"webapplicatie",beschrijving:"Zwakheden in het authenticatiemechanisme zoals zwakke wachtwoorden, ontbrekende rate limiting of onveilige sessie-tokens.",stappen:`Stap 1: Test brute force op login zonder lockout
Stap 2: Analyseer sessie-tokens op voorspelbaarheid
Stap 3: Test wachtwoord-reset flow`,risico:"Accountovername, onbevoegde toegang, privilege escalation.",aanbeveling:"Multi-factor authenticatie. Account lockout na mislukte pogingen. Sterke sessie-tokens (128-bit random). HTTPS-only cookies."},{id:4,titel:"Outdated OS / Kernel",categorie:"laptop",beschrijving:"Het besturingssysteem of de kernel bevat bekende kwetsbaarheden door verouderde versies zonder patches.",stappen:`Stap 1: Identificeer OS-versie: uname -a / winver
Stap 2: Zoek bekende CVEs op
Stap 3: Test exploiteerbare kwetsbaarheden`,risico:"Local privilege escalation naar SYSTEM/root. Volledige machinecompromis.",aanbeveling:"Automatische updates inschakelen. Patch management proces implementeren. End-of-life systemen vervangen."},{id:5,titel:"Onversleuteld Lokaal Opgeslagen Data",categorie:"laptop",beschrijving:"Gevoelige data zoals credentials, sleutels of PII wordt onversleuteld opgeslagen op het lokale bestandssysteem.",stappen:`Stap 1: Zoek naar credentials in clear text: grep -r "password" /home
Stap 2: Controleer configuratiebestanden
Stap 3: Analyseer browser-opgeslagen wachtwoorden`,risico:"Bij fysieke toegang of malware: directe toegang tot credentials en gevoelige bedrijfsdata.",aanbeveling:"Full disk encryption (BitLocker/FileVault). Gebruik credential managers. Verwijder clear-text credentials uit bestanden."},{id:6,titel:"SMB Relay Attack",categorie:"interne-infrastructuur",beschrijving:"NTLM-authenticatieverkeer kan worden onderschept en doorgestuurd naar andere systemen om authenticatie te omzeilen.",stappen:`Stap 1: Start Responder: responder -I eth0
Stap 2: Wacht op NTLM-authenticatiepogingen
Stap 3: Relay met ntlmrelayx naar doelsystemen`,risico:"Authenticatie op andere systemen in het netwerk zonder wachtwoord. Potentieel domeincompromis.",aanbeveling:"SMB signing verplicht maken op alle systemen. NTLM uitschakelen waar mogelijk. NetBIOS en LLMNR uitschakelen."},{id:7,titel:"Kerberoasting",categorie:"interne-infrastructuur",beschrijving:"Service accounts met SPNs kunnen worden aangevallen door Kerberos TGS-tickets offline te kraken.",stappen:`Stap 1: Identificeer service accounts met SPNs: GetUserSPNs.py
Stap 2: Request TGS tickets
Stap 3: Kraak offline met hashcat`,risico:"Compromis van service account wachtwoorden, mogelijk met hoge privileges.",aanbeveling:"Gebruik gManaged Service Accounts (gMSA). Lange complexe wachtwoorden voor service accounts (>25 tekens). Privileged Access Workstations."},{id:8,titel:"Exposed Management Interfaces",categorie:"externe-infrastructuur",beschrijving:"Beheerpanelen (SSH, RDP, admin panels) zijn direct benaderbaar vanaf het internet.",stappen:`Stap 1: Scan met nmap: nmap -p 22,3389,8080,8443 target
Stap 2: Identificeer versies en diensten
Stap 3: Test standaard credentials`,risico:"Brute force aanvallen, exploitatie van bekende kwetsbaarheden, onbevoegde toegang.",aanbeveling:"VPN of jump server verplicht voor beheer. IP whitelisting. Geen RDP/SSH direct op internet."},{id:9,titel:"Subdomain Takeover",categorie:"externe-infrastructuur",beschrijving:"DNS-records verwijzen naar niet-meer-bestaande cloud services, waardoor een aanvaller de subdomain kan claimen.",stappen:`Stap 1: Enumerate subdomains: subfinder, amass
Stap 2: Controleer CNAME records: dig CNAME sub.example.com
Stap 3: Verifieer of de cloud resource nog bestaat`,risico:"Phishing via legitiem ogend domein, sessiecookie diefstal, reputatieschade.",aanbeveling:"Verwijder DNS records bij decommissioneren van services. Regelmatige audit van DNS-configuratie."},{id:10,titel:"Phishing Simulatie Geslaagd",categorie:"red-teaming",beschrijving:"Medewerkers klikken op gesimuleerde phishing e-mails en voeren credentials in op nep-loginpaginas.",stappen:`Stap 1: Maak overtuigende phishing e-mail met GoPhish
Stap 2: Stuur naar doelgroep
Stap 3: Meet click-rate en credential submissions`,risico:"Credential diefstal, malware installatie, initiële toegang tot netwerk.",aanbeveling:"Security awareness training. E-mail filtering (DMARC, SPF, DKIM). MFA op alle systemen. Phishing-resistente MFA (FIDO2)."},{id:11,titel:"Hardcoded Credentials in Broncode",categorie:"code-review",beschrijving:"API-sleutels, wachtwoorden of tokens zijn direct in de broncode opgenomen.",stappen:`Stap 1: Scan met git-secrets of truffleHog
Stap 2: Grep naar keywords: grep -r "password\\|secret\\|key" src/
Stap 3: Controleer git history`,risico:"Onbevoegde toegang tot externe services, databases of cloud resources.",aanbeveling:"Gebruik environment variables of secret managers (HashiCorp Vault, AWS Secrets Manager). Pre-commit hooks voor secret detection. Git history schoonmaken."},{id:12,titel:"Misconfigured S3 Bucket",categorie:"cloud",beschrijving:"AWS S3 buckets zijn publiek toegankelijk of hebben te ruime IAM-permissies.",stappen:`Stap 1: Enumerate buckets: aws s3 ls
Stap 2: Test publieke toegang: curl https://bucket.s3.amazonaws.com
Stap 3: Controleer bucket policies en ACLs`,risico:"Datalekken van gevoelige bestanden, mogelijke write-access voor aanvallers.",aanbeveling:"Block Public Access inschakelen op account-niveau. Least privilege IAM policies. S3 bucket logging en monitoring inschakelen. Regelmatige audit met AWS Config."}],N=[{id:1,naam:"Admin Gebruiker",email:"admin@pentestpro.nl",rol:"beheerder",actief:!0},{id:2,naam:"Alice Smit",email:"alice@redteam.nl",rol:"pentester",actief:!0},{id:3,naam:"Bob Jansen",email:"bob@redteam.nl",rol:"pentester",actief:!0},{id:4,naam:"Carol de Wit",email:"carol@redteam.nl",rol:"pentester",actief:!0},{id:5,naam:"Erik Visser",email:"erik@redteam.nl",rol:"pentester",actief:!1},{id:6,naam:"Petra Bakker",email:"petra@technova.nl",rol:"lezer",actief:!0}],l=g([]),v=g(1),s=g([]),c=g([]),m=g(!1);function O(){m.value||(l.value=JSON.parse(JSON.stringify(A)),s.value=JSON.parse(JSON.stringify(E)),c.value=JSON.parse(JSON.stringify(N)),m.value=!0);const d=b(()=>l.value.find(t=>t.id===v.value)??null);function h(t){v.value=t}function f(t,e,i){const n=l.value.reduce((o,p)=>Math.max(o,p.id),0);l.value.push({id:n+1,bedrijf:t,contactNaam:"",contactEmail:"",contactTel:"",aanpak:e,testSoorten:[],risicoNiveau:"",status:i,datum:new Date().toISOString().slice(0,10),samenvatting:"",conclusie:"",pentesters:[],bevindingen:[]}),v.value=n+1}function k(t,e,i){const n=d.value;if(!n)return;const o=n.bevindingen.reduce((p,u)=>Math.max(p,u.id),0);n.bevindingen.push({id:o+1,titel:t,severiteit:e,status:i,checked:!1,referentie:"",beschrijving:"",stappen:"",risico:"",aanbeveling:"",fotos:[]})}function S(t){const e=d.value;e&&(e.bevindingen=e.bevindingen.filter(i=>i.id!==t))}function w(t){const e=d.value;if(!e)return;const i=s.value,n={};i.forEach(r=>{n[r.categorie]||(n[r.categorie]=new Set),n[r.categorie].add(r.titel.toLowerCase())});const o=new Set;t.forEach(r=>{i.filter(a=>a.categorie===r).forEach(a=>o.add(a.titel.toLowerCase()))});const p=new Set(i.map(r=>r.titel.toLowerCase()));e.bevindingen=e.bevindingen.filter(r=>{const a=r.titel.toLowerCase();return p.has(a)?o.has(a):!0});const u=new Set(e.bevindingen.map(r=>r.titel.toLowerCase()));t.forEach(r=>{i.filter(a=>a.categorie===r).forEach(a=>{if(u.has(a.titel.toLowerCase()))return;const R=e.bevindingen.reduce((M,L)=>Math.max(M,L.id),0);e.bevindingen.push({id:R+1,titel:a.titel,severiteit:"nvt",status:"open",checked:!1,referentie:"",beschrijving:a.beschrijving,stappen:a.stappen,risico:a.risico,aanbeveling:a.aanbeveling,fotos:[]}),u.add(a.titel.toLowerCase())})})}const j=b(()=>l.value.reduce((t,e)=>t+e.bevindingen.filter(i=>i.status==="open").length,0)),C=b(()=>{const t=d.value;return t?["kritiek","hoog","gemiddeld","laag","informatief"].reduce((e,i)=>(e[i]=t.bevindingen.filter(n=>n.severiteit===i).length,e),{}):{kritiek:0,hoog:0,gemiddeld:0,laag:0,informatief:0}});function T(t){const e=s.value.reduce((i,n)=>Math.max(i,n.id),0);s.value.push({...t,id:e+1})}function y(t){s.value=s.value.filter(e=>e.id!==t)}function I(t){const e=c.value.reduce((i,n)=>Math.max(i,n.id),0);c.value.push({...t,id:e+1})}function P(t){c.value=c.value.filter(e=>e.id!==t)}return{reports:l,currentReport:d,currentReportId:v,setCurrentReport:h,addReport:f,addBevinding:k,deleteBevinding:S,syncBevindingen:w,totalOpen:j,sevCounts:C,dbBevindingen:s,addDbBevinding:T,deleteDbBevinding:y,users:c,addUser:I,deleteUser:P}}export{O as u};
